doctype html
html
  head
    title Map travel time
    link(rel="stylesheet", href="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css", text="text/css")
    link(rel="stylesheet", href="/css/index.css", text="text/css")
  body
    .map

    //- Load our application
    script(src="/js/index.js")
    script.
      window.app = new window.Application({
        el: document.querySelector('.map')
      });

    //- Load our GTFS data
    //- TODO: Re-encode data via protobuf and optimize it for our needs as per Mapnificent
    //- DEV: We trim loaded data to prevent empty lines being parsed
    script
      - var fs = require('fs');
      - var jsStringify = require('js-stringify');
      //- TODO: Expand out data before passing it to app so we have a sane API
      - var data = JSON.parse(fs.readFileSync(__dirname + '/../tmp.txt', 'utf8'))
      | window.app.loadData({
      |   data: !{jsStringify(data)}
      | });
